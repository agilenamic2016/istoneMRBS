<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, minimum-scale=1, width=device-width, target-densitydpi=medium-dpi" />
        <title>Home Page</title>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/jquery-mobile/jquery.mobile-1.4.5.js"></script>
        <script type="text/javascript" src="js/jquery/jquery.js"></script>
        <script type="text/javascript" src="js/jquery-ui/jquery-ui.js"></script>
        <script type="text/javascript" src="js/common.js"></script>
        <script type="text/javascript" src="js/calendarView.js"></script>
        <script type="text/javascript" src="js/web_request.js"></script>
        <link rel="stylesheet" type="text/css" href="js/jquery-ui/jquery-ui.css" />
        <link rel="stylesheet" type="text/css" href="css/common.css" />
        <link rel="stylesheet" type="text/css" href="css/calendarView.css" />
        <script type="text/javascript">
            $(document).ready(function(){
                $(".ui-select span").hide();
                $("#buttonbg").on("touchstart",function(startevent){
                    goBack();
                });
            });
            
            function goBack(){
                window.location="roomList.html";    
            }
            
            $(document).bind('mobileinit',function(){
                $.mobile.loadingMessage = false;
            })
            
            document.addEventListener("deviceready", onDeviceReady, false);
            var menuStatus;
            
            function onDeviceReady() {
                //document.addEventListener("backbutton", onBackKeyDown, false);
            }
            
//            function onBackKeyDown(e) {
//              e.preventDefault();
//            }
        </script>
    </head>
    <body id="pageBody" class="appBody">
        <div data-role="app" class="app" id="app">
            
            <div class="menuheader">
                <div class="menuheaderleft">
                    <button class="buttonbg" id="buttonbg">
                        <img class="menubutton" src="img/arrowleft.png"/>
                    </button>
                </div>
                <div><span class="roomName" id="roomName"></span></div>
                <div class="menuheaderright">
                     <button class="pagetitle"><img class="pageTitileImg" src="img/companylogo.png"/>RBS</button>
<!--                    <button class="pageTitileImgBG" id="pageTitileImgBG" onclick=""></button>-->
                </div>
            </div>
            <div class="menubg">
                <div>
                    <ul id="slidemenu">
                        <script type="text/javascript" src="js/slidemenuitem.js"></script>
                    </ul>    
                </div>
                <div class="menufooter">
                    <img src="img/menufooter-2.png" class="footerimage"/>
                </div>
            </div>
            <div class="content">
                <center>
                    <input type="text" id="dateBooking" style="display:none">
                    <div id="datepicker" style="width:100%"></div>
                </center>
<!--                <textarea id="txtPurpose" maxlength="500"></textarea>-->
                <div class="inputField" style="top:42%;width:100%">
                    &nbsp;&nbsp;&nbsp;Title
                    <input id="txtTitle" maxlength="100" type="text" style="height:7vw;line-height:7vw;width:70%;float:right;margin-right:5%"/>
                </div>
                <div class="inputField" style="top:49%;width:100%">
                     &nbsp;&nbsp;&nbsp;Purpose
                    <textarea id="txtPurpose" maxlength="100" style="height:21vw;line-height:7vw;width:69%;float:right;margin-right:5%"></textarea>
                </div>
                <div class="inputField" style="top:69%;">
                <img src="img/clock.jpg" class="comboImg" style="left:2%;"/>
                <select id="startTime" class="comboTime" style="left:13%">
                    <option>00:00</option>
                    <option>00:30</option>
                    <option>01:00</option>
                    <option>01:30</option>
                    <option>02:00</option>
                    <option>02:30</option>
                    <option>03:00</option>
                    <option>03:30</option>
                    <option>04:00</option>
                    <option>04:30</option>
                    <option>05:00</option>
                    <option>05:30</option>
                    <option>06:00</option>
                    <option>06:30</option>
                    <option>07:00</option>
                    <option>07:30</option>
                    <option>08:00</option>
                    <option>08:30</option>
                    <option>09:00</option>
                    <option>09:30</option>
                    <option>10:00</option>
                    <option>10:30</option>
                    <option>11:00</option>
                    <option>11:30</option>
                    <option>12:00</option>
                    <option>12:30</option>
                    <option>13:00</option>
                    <option>13:30</option>
                    <option>14:00</option>
                    <option>14:30</option>
                    <option>15:00</option>
                    <option>15:30</option>
                    <option>16:00</option>
                    <option>16:30</option>
                    <option>17:00</option>
                    <option>17:30</option>
                    <option>18:00</option>
                    <option>18:30</option>
                    <option>19:00</option>
                    <option>19:30</option>
                    <option>20:00</option>
                    <option>20:30</option>
                    <option>21:00</option>
                    <option>21:30</option>
                    <option>22:00</option>
                    <option>22:30</option>
                    <option>23:00</option>
                    <option>23:30</option>
                </select>
                <span class="inputLabel">To</span>
                <img src="img/clock.jpg" class="comboImg" style="left:45%;"/>
                <select id="endTime" class="comboTime" style="left:57%">
                    <option>00:00</option>
                    <option>00:30</option>
                    <option>01:00</option>
                    <option>01:30</option>
                    <option>02:00</option>
                    <option>02:30</option>
                    <option>03:00</option>
                    <option>03:30</option>
                    <option>04:00</option>
                    <option>04:30</option>
                    <option>05:00</option>
                    <option>05:30</option>
                    <option>06:00</option>
                    <option>06:30</option>
                    <option>07:00</option>
                    <option>07:30</option>
                    <option>08:00</option>
                    <option>08:30</option>
                    <option>09:00</option>
                    <option>09:30</option>
                    <option>10:00</option>
                    <option>10:30</option>
                    <option>11:00</option>
                    <option>11:30</option>
                    <option>12:00</option>
                    <option>12:30</option>
                    <option>13:00</option>
                    <option>13:30</option>
                    <option>14:00</option>
                    <option>14:30</option>
                    <option>15:00</option>
                    <option>15:30</option>
                    <option>16:00</option>
                    <option>16:30</option>
                    <option>17:00</option>
                    <option>17:30</option>
                    <option>18:00</option>
                    <option>18:30</option>
                    <option>19:00</option>
                    <option>19:30</option>
                    <option>20:00</option>
                    <option>20:30</option>
                    <option>21:00</option>
                    <option>21:30</option>
                    <option>22:00</option>
                    <option>22:30</option>
                    <option>23:00</option>
                    <option>23:30</option>
                </select>
                </div>
                <div class="inputField" style="top:67%;">
                    <button id="btnBook"><img src="img/booknow.png" class="buttonImg"/></button>
                </div>
                <div class="inputField" style="top:78%;width:100%">
                    <span class="inputLabel" style="left:0px;">&nbsp;&nbsp;&nbsp;Repeat</span>
                    <select id="repeatType" class="comboTime" style="left:30%;width:50%;" onchange="changeRepeat();">
                    <option>No Repeat</option>
                    <option>Daily</option>
                    <option>Weekly</option>
                    <option>Monthly</option>
                </select>   
                </div>
                <div class="inputField" style="top:85%;width:100%;display:none;" id="endDateDiv">
                    <span class="inputLabel" style="left:0px;">&nbsp;&nbsp;&nbsp;Start Date</span>
                    <input id="startDate" class="comboTime" style="left:30%;width:50%;"/>  
                </div>
                <div class="inputField" style="top:92%;width:100%;display:none;" id="startDateDiv">
                    <span class="inputLabel" style="left:0px;">&nbsp;&nbsp;&nbsp;End Date </span>
                    <input id="endDate" class="comboTime" style="left:30%;width:50%;" type="text"/>
                </div>
                <div class="inputField" style="bottom:15%;display:none;"><h1>Booking history</h1></div>
                <div class="pageone" style="display:none">
                    <div class="wrapper" id="wrapper">
                        <div class="scroll-content" id="scroll-content">
                            <ul class="scrollul" id="scrollul">
<!--
                                <li class='scrollli' id='featuredrow1' onclick="goCalendar();"><table style='height:100%; width:100%;'><tr><td><h1 class='listviewitemtitle'>Richard Goh</h1><p class='listviewitemseperator'>&nbsp;</p><p class='listviewitemdetails'>DateTime: 14 May 2016 14:00 - 16:00</p></td></tr></table>
                                </li>
                                <li class='scrollli' id='featuredrow1' onclick="goCalendar();"><table style='height:100%; width:100%;'><tr><td><h1 class='listviewitemtitle'>Ahmad Dahlan</h1><p class='listviewitemseperator'>&nbsp;</p><p class='listviewitemdetails'>DateTime: 14 May 2016 09:00 - 11:00</p></td></tr></table>
                                </li>
                                <li class='scrollli' id='featuredrow1' onclick="goCalendar();"><table style='height:100%; width:100%;'><tr><td><h1 class='listviewitemtitle'>Ho Chon Weh</h1><p class='listviewitemseperator'>&nbsp;</p><p class='listviewitemdetails'>DateTime: 13 May 2016 15:00 - 16:00</p></td></tr></table>
                                </li>
                                <li class='scrollli' id='featuredrow1' onclick="goCalendar();"><table style='height:100%; width:100%;'><tr><td><h1 class='listviewitemtitle'>Jason Tan</h1><p class='listviewitemseperator'>&nbsp;</p><p class='listviewitemdetails'>DateTime: 13 May 2016 11:00 - 13:00</p></td></tr></table>
                                </li>
                                <li class='scrollli' id='featuredrow1' onclick="goCalendar();"><table style='height:100%; width:100%;'><tr><td><h1 class='listviewitemtitle'>Jason Tan</h1><p class='listviewitemseperator'>&nbsp;</p><p class='listviewitemdetails'>DateTime: 11 May 2016 09:30 - 10:30</p></td></tr></table>
                                </li>
-->
                            </ul>
                            <br>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            $( "#datepicker" ).datepicker({ minDate: 0,
                                            altField: '#dateBooking'
                                          });
              $( function() {
                $( "#startDate" ).datepicker();
              } );
            $( function() {
                $( "#endDate" ).datepicker();
              } );
            var theScroll;
            function scroll() {
                theScroll = new iScroll('wrapper');
            }     
        
            $(document).ready(function(){
                dbmanager.initdb();
                
                var roomname=getUrlParameter("name");
                var roomid=getUrlParameter("id");
                $("#roomName").html(roomname);
                
                
//                dbmanager.getSession(function(returnData){
//                        if(returnData.rows.length>0)
//                        {   
//                            loading.startLoading();
//                            bookingHistory(returnData.rows.item(0).token, $("#dateBooking").val(),roomid);
//                        }
//                    });
                
                
                $("#buttonbg").on("click",function(startevent){
                    window.history.back();
                });
                
                
                
                $("#btnBook").on("click",function(startevent){
                   dbmanager.getSession(function(returnData){
                        if(returnData.rows.length>0)
                        {   
                            if($("#startTime").val()>$("#endTime").val()){
                                alert("invalid time");
                            }
                            else if($("#txtTitle").val()==""){
                                alert("Please insert title");
                            }
                            else if($("#txtPurpose").val()==""){
                                alert("Please insert purpose");
                            }
                            else{
                                loading.startLoading();
                                bookRoom(returnData.rows.item(0).token, $("#txtTitle").val(), $("#txtPurpose").val(), $("#dateBooking").val(), $("#startTime").val(), $("#endTime").val(), roomid, $("#repeatType").val(),$("#startDate").val(),$("#endDate").val())
                            }
                        }
                    });
                    
                });
            });
            
            function changeRepeat(){
                if($("#repeatType").val()=="No Repeat"){
                    $("#endDateDiv").css("display", "none");
                    $("#startDateDiv").css("display", "none");
                }
                else{
                    $("#endDateDiv").css("display", "");
                    $("#startDateDiv").css("display", "");
                }
                
            }
        </script>
    </body>
</html>